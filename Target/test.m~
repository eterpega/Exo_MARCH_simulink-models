udp = dsp.UDPSender()
s = splineController();
r = robotics();
base = 3;
torso_delta = [0 0.1 0];

r.base = base;

%% Weight Shift
% if(base == 1)
%     torso_delta(2) = -abs(torso_delta(2));
% else
%     torso_delta(2) = abs(torso_delta(2));
% end
% 
% torsoTrajectory = s.getWeightShift(torso_delta);
% 
% for i = 1:length(torsoTrajectory)
%     r.weightShift(torsoTrajectory(i,:));
%     r.inverseKinematics();
%     
%     q = r.q;
%     step(udp,q);
%     pause(1/2000);
% end
 r.refresh();
%% Step sequence
s.setStepHeight(0.2).setStepLength(0.3);

trajectory = s.method('circle').setVelocity(0.5).getHalfStep();
trajectory = r.transformSpline(trajectory);

for j = 1:length(trajectory)
    r.point = [trajectory(1,j) trajectory(2,j) trajectory(3,j)];
    
    r.step();
    r.inverseKinematics();
    
    q = r.q;
    step(udp,q);
    pause(1/2000);
end
r.refresh();
r.base = 1;
trajectory = s.method('circle').setVelocity(0.5).getFullStep();
trajectory = r.transformSpline(trajectory);

for j = 1:length(trajectory)
    r.point = [trajectory(1,j) trajectory(2,j) trajectory(3,j)];
    
    r.step();
    r.inverseKinematics();
    
    q = r.q;
    step(udp,q);
    pause(1/2000);
end


